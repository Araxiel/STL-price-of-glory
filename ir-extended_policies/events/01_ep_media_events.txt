###############################
# Extended Policy Events
# by Araxiel
###############################

##### Media Events
namespace = ep_media_event

# ep_media_event.1		- State Media - subversive media initiator - hidden event
planet_event = {
	id = ep_media_event.1

	hide_window = yes

	mean_time_to_happen = {
		years = 65
		modifier = {
			factor = 0.5
			OWNER = {
				has_policy_flag = "regulation_state_media"
			}
		}
	}

	trigger = {
		has_owner = yes
		years_passed > 10
		OWNER = {
			count_owned_pops = {
				limit = {	is_enslaved = no }
				count > 15
			}
			OR = {
				has_policy_flag = "regulation_state_media"
				has_policy_flag = "regulation_controlled_media"
			}
		}
		count_owned_pops = {
			limit = {	is_enslaved = no }
			count > 3
		}
		NOT = { has_planet_flag = recent_subversive_media }
		is_capital = no
	}

	after = {
	}

	immediate = {
		save_event_target_as = subversive_media_planet
		random_list = {
			## not found
			30 = {
				planet_event = { id = ep_media_event.2 days = 10 random = 10 }
			}
			## being found
			60 = {
				planet_event = { id = ep_media_event.3 days = 10 random = 10 }
			}
		}
		set_timed_planet_flag = {
			flag = recent_subversive_media
			days = 720
		}
	}
}

# ep_media_event.2		- State Media - subversive media not intercepted
planet_event = {
	id = ep_media_event.2
	title = ep_media_event.2.title
	desc = "ep_media_event.2.desc"
	location = ROOT

	picture = GFX_evt_smugglers_in_bar
	show_sound = event_factions

	is_triggered_only = yes

	trigger = {
	}

	after = {
	}

	immediate = {
		add_modifier = {
			modifier = subversive_media
			days = 2000 # 5.4 years / 66 months
		}
	}

	option = {
		name = OK
		tooltip = {
			add_modifier = {
				modifier = subversive_media
				days = 2000 # 5.4 years / 66 months
			}
		}
	}
}

# ep_media_event.3		- State Media - subversive media intercepted
planet_event = {
	id = ep_media_event.3
	title = ep_media_event.3.title
	desc = "ep_media_event.3.desc"
	picture = GFX_evt_cyberpunk_cops
	show_sound = event_combine_chatter

	location = ROOT

	is_triggered_only = yes

	trigger = {
	}

	after = {
	}

	immediate = {
	}

	# raid
	option = {
		name = ep_media_event.3.a
		add_modifier = {
			modifier = raided_political_opponents
			days = 2000 # 5.4 years
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2
				unrest < 50
			}
			modifier = {
				factor = 3
				OWNER = {
					OR = {
						has_ethic = ethic_fanatic_militarist
						has_ethic = ethic_fanatic_spiritualist
						has_ethic = ethic_fanatic_xenophobe
					}
				}
			}
			modifier = {
				factor = 2
				OWNER = {
					has_ethic = ethic_fanatic_authoritarian
				}
			}
		}
	}

	# no-raid
	option = {
		name = ep_media_event.3.b
		add_modifier = {
			modifier = subversive_media
			days = 2000 # 5.4 years
		}
		ai_chance = {
			factor = 100
			modifier = {
				factor = 2
				unrest > 50
			}
			modifier = {
				factor = 2
				OWNER = {
					OR = {
						has_ethic = ethic_egalitarian
						has_ethic = ethic_xenophile
						has_ethic = ethic_fanatic_xenophile
					}
				}
			}
		}
	}

}
